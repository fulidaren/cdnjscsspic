(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{22:function(e,t,o){e.exports=o("uyRU")},F65g:function(e,t,o){},uyRU:function(e,t,a){"use strict";(function(k){var e=a("TqRt");a("Tze0"),a("eM6i"),a("pIFo"),a("V+eJ"),a("SRfc"),a("OG14"),a("KKXr");var t=e(a("lwsE")),o=e(a("W8MJ")),i=e(a("ixR2")),n=e(a("lPLa"));a("F65g");var R=e(a("HJ22")),L=new i["default"],w=new(function(){function e(){(0,t["default"])(this,e),this.timer=null,this.client=n["default"].client,this.backUrl=location.search.split("backurl=")[1]}return(0,o["default"])(e,[{key:"getMatchType",value:function(){var e=decodeURIComponent(location.search).match(/(\?type|state)\=([a-z0-9]+)/i);return!!e&&e[2].toLocaleLowerCase()}},{key:"getThirdLoginURL",value:function(e){return"/thirdlogin/?type=".concat(e)}},{key:"getAutoLoginParams",value:function(e){var t=e.type,o=e.openid;return t?{type:t,openid:o}:(L.layer.toast("未获取到登录方式，请重新刷新再试!"),!1)}},{key:"getAiqiyiBack",value:function(e){var t=e.Uid,o=e.Uname,i=e.type,n=e.openid;return!!w.backUrl&&(window.location.href="".concat(decodeURIComponent(w.backUrl),"&uid=").concat(t,"&type=").concat(i,"&username=").concat(o,"&openid=").concat(n),!0)}},{key:"login",value:function(e,o){var i=this;L.user.getUserInfo(e,function(e,t){return e?(L.layer.toast(e),void(isPending=!1)):!i.getAiqiyiBack(t)&&void L.layer.toast("登录成功,正在跳转...",2,function(){L.util.limitStore(n["default"].recordType.history,null),L.util.limitStore(n["default"].recordType.collect,null),o&&L.util.cookie("oldloginvar",o,{expires:8760}),i.saveUserInfo(t);var e=L.util.cookie("loginRefererURL")||"/";e&&(L.util.cookie("loginRefererURL",null),-1<e.indexOf("#")&&(e=e.split("#")[0]),window.location=e)})})}},{key:"jumpThirdAuthLogin",value:function(e){if(this.setLoginRefererURL(),w.backUrl)return L.user.logout(!0,function(){top.location=e}),!1;L.user.logout(!0),top.location=e}},{key:"setLoginRefererURL",value:function(){var e=top.location.href,t=e!==location.href?e:document.referrer;(2!==t.replace(/^https?:/,"").indexOf(location.host)||-1<t.indexOf("login.htm"))&&(t=null),L.util.cookie("loginRefererURL",t,{expires:8760})}},{key:"saveUserInfo",value:function(e){e.lastlogintime=e.lastlogintime?e.lastlogintime:Date.now()}},{key:"userLoginRequest",value:function(e,o){L.util.ajax({url:"/login/byuser/",method:"post",data:e},function(e,t){"function"==typeof o&&o(e,t)})}},{key:"imageCodeValidateRequest",value:function(e,o){L.util.ajax({url:"/api/mkxq/mobilevc/",method:"get",cache:!0,dataType:"json",data:e},function(e,t){e?"function"==typeof o&&o(e):"function"==typeof o&&o(null,"发送成功，请等待接收")})}},{key:"mobileBindLoginRequest",value:function(e,o){L.util.ajax({url:"/api/mkxq/mobilebind/",type:"post",dataType:"json",data:e},function(e,t){"function"==typeof o&&o(e,t)})}}]),e}());k(function(){var e=k("#J_mobile"),t=k("#J_account"),o=k("#J_thirdLogin"),i=k("#J_login_type"),n=k("#J_login_type_1"),a=k("#J_login_type_2"),l=k("#J_lookpassword"),r=k("#J_sendCode"),c=k("#J_sendCodeTips"),s=k("#mobile"),u=k("#SMS"),d=k("#account"),f=k("#password"),p=k("#J_login"),y=k("#J_forgetPassword"),h=/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,v=!1,g=new R["default"]({account:s}),m=!0;i.on("click",function(){(m=!m)?(n.addClass("hide"),a.removeClass("hide"),t.show(),e.addClass("hide"),y.removeClass("hidden")):(n.removeClass("hide"),a.addClass("hide"),t.hide(),e.removeClass("hide"),y.addClass("hidden"))}),l.on("click",function(){var e=k(this);e.hasClass("ift-eye-close")?(f.attr("type","text"),e.attr("class","ift-eye-open")):(f.attr("type","password"),e.attr("class","ift-eye-close"))}),o.on("click",".item",function(){var e=k(this).data("type"),t=w.getThirdLoginURL(e),o=document.referrer;t+="&referrer="+encodeURIComponent(o),w.backUrl&&(t+="&backurl="+w.backUrl),w.jumpThirdAuthLogin(t)}),p.on("click",function(){if(!v)if(m){var e={identity:d.val().trim(),pwd:f.val().trim()};e.identity&&e.pwd?(v=!0,w.userLoginRequest(e,function(e,t){if(e)return L.layer.toast(e),void(v=!1);w.setLoginRefererURL();var o={type:"mkxq",client:w.client,token:t.appToken,isLogin:!0};w.login(o)})):L.layer.toast("请检查您的输入")}else{var t={mobile:s.val().trim(),vcode:u.val().trim()};if(!h.test(t.mobile))return void L.layer.toast("请输入正确的手机号码");if(!t.vcode)return void L.layer.toast("请输入短信验证码");v=!0,w.mobileBindLoginRequest(t,function(e,t){if(e)return L.layer.toast(e),void(v=!1);w.setLoginRefererURL();var o={type:"mkxq",client:w.client,token:t.appToken,isLogin:!0};w.login(o)})}}),r.on("click",function(){var e=s.val();h.test(e)?(g.countDownCallback=function(){L.util.countDown(function(e){0===e?(c.addClass("hide"),r.removeClass("hide")):(c.hasClass("hide")&&c.removeClass("hide"),r.hasClass("hide")||r.addClass("hide"),c.text("还剩".concat(e,"秒")).removeClass("hide"))},60)},g.getImageAuthentication({mobile:e},function(e,t){e&&L.layer.toast(e)})):L.layer.toast("请输入正确的手机号码")})})}).call(this,a("+2Rf"))}},[[22,0,1]]]);